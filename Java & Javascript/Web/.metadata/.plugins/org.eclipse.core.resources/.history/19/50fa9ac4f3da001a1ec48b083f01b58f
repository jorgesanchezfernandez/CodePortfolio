<?xml version="1.0" encoding="ISO-8859-1" ?>
<%@ page language="java" contentType="text/html; charset=ISO-8859-1"
    pageEncoding="ISO-8859-1" import="java.util.*,Perrera.*"%>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
<title>Insert title here</title>
</head>
<body>
<%
	String numSerie = request.getParameter("numSerie");
	LineaPeticion sessionPeticiones = null;

	

	// si el parámetro no es nulo (se acceder directamente a carrito) o si su longitud no es mayor a cero
	if(numSerie!=null && numSerie.length()>0)
	{
		
		
		//Usuario usu=(Usuario)session.getAttribute("session.usu");
		//Peticion pet = new Peticion();
		//opcion B
		List lista=AnimalStore.getInstance().getAnimales();
		Iterator it=lista.iterator();
		Animal ani=null;
		boolean encontrado=false;
		while(it.hasNext() && !encontrado){
			ani=(Animal)it.next();
			if(ani.getNumSerie().equals(numSerie))
				encontrado=true;
		}
		
		sessionPeticiones=(LineaPeticion)session.getAttribute("session.peticiones");
		if(sessionPeticiones == null)  {
		   sessionPeticiones = new LineaPeticion();
		}
		try{
			sessionPeticiones.addPeticion(ani);
		}catch(Exception e){
			System.out.println("Maximo de peticiones alcanzadas");
		}
		session.setAttribute("session.peticiones", sessionPeticiones);
	}
	else
	{
	System.out.println("Animal no encontrado");
	
	}
%>

</body>
</html>